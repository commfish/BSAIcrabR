sum(grepl("group", names(total_catch)))
sum(grepl("sex", names(total_catch)))
total_catch
sum(grepl(c("group", "sex"), names(total_catch)))
sum(grepl("group"|"sex", names(total_catch)))
sum(grepl("group|sex", names(total_catch)))
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex)
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
mutate(total_catch_n = sum(total_catch_n),
total_catch_wt = sum(total_catch_wt))
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n),
total_catch_wt = sum(total_catch_wt))
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n),
total_catch_wt = sum(total_catch_wt), .drop = T)
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T), .drop = T)
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T)) %>% ungroup
retained_catch %>%
mutate(sex = 1)
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T)) %>% ungroup %>%
# join to retained catch
full_join(retained_catch %>%
mutate(sex = 1), by = c("crab_year", "fishery", "sex"))
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T)) %>% ungroup %>%
# join to retained catch
full_join(retained_catch %>%
mutate(sex = 1), by = c("crab_year", "fishery", "sex")) %>%
mutate(retained_n = ifelse(sex == 2, 0, retained_n),
retained_wt = ifelse(sex == 2, 0, retained_wt))
handling_mortality = 0.3
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T)) %>% ungroup %>%
# join to retained catch
full_join(retained_catch %>%
mutate(sex = 1), by = c("crab_year", "fishery", "sex")) %>%
mutate(retained_n = ifelse(sex == 2, 0, retained_n),
retained_wt = ifelse(sex == 2, 0, retained_wt)) %>%
# add discards
mutate(discard_n = total_catch_n - retained_n,
discard_wt = total_catch_wt - retained_wt)
total_catch %>%
# filter for the directd fishery
filter(substring(fishery, 1, 2) == fish_code) %>%
group_by(crab_year, fishery, sex) %>%
summarise(total_catch_n = sum(total_catch_n, na.rm = T),
total_catch_wt = sum(total_catch_wt, na.rm = T)) %>% ungroup %>%
# join to retained catch
full_join(retained_catch %>%
mutate(sex = 1), by = c("crab_year", "fishery", "sex")) %>%
mutate(retained_n = ifelse(sex == 2, 0, retained_n),
retained_wt = ifelse(sex == 2, 0, retained_wt)) %>%
# add discards
mutate(discard_n = total_catch_n - retained_n,
discard_wt = total_catch_wt - retained_wt,
discard_mortality_n = discard_n * handling_mortality + retained_n,
discard_mortality_wt = discard_wt * handling_mortality + retained_wt)
document()
usethis::document()
devtools::document()
pkg::build_site()
pkgdown::build_site()
path = "../adfg_crab_observer/tanner_crab/data/TANNER-1990-2023_retained_size_freq.csv"
dock <- read_csv(path)
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, spcode, size, legal, shell, numcrab) -> out
dock
dock <- read_csv(path)
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, spcode, size, legal, shell, numcrab) -> out
out
out %>%
count(crab_year, substring(fishery 3, 4))
out %>%
count(crab_year, substring(fishery, 3, 4))
out %>%
count(crab_year, substring(fishery, 3, 4)) %>% print(n = 100)
early_90s_tt <- c("EI89", "EI90", "EI91", "EI92", paste0("QT", 93:96))
out %>%
# fix transition to rationalization yr
# cdq and eo fisheries to QO
# bbrkc test fish and cdq fisheries to TR
# early tanner crab fisheries to QT or TT based on e166 line
# fisheries without any dates in dockside data (make hard change)
mutate(fishery = gsub("QO05r", "QO05", fishery),
fishery = gsub("QO05o", "QO04", fishery),
fishery = gsub("CO|EO", "QO", fishery),
fishery = gsub("XR|CR", "TR", fishery),
fishery = ifelse(fishery %in% early_90s_tt, paste0("QT", substring(fishery, 3, 4)), fishery),
fishery = ifelse(fishery %in% c("EO91", "EO92"), paste0(substring(fishery, 1, 2), as.numeric(substring(fishery, 3, 4))-1), fishery)) -> out
out %>%
count(crab_year, substring(fishery, 3, 4)) %>% print(n = 100)
out %>%
count(crab_year, substring(fishery, 1, 2), substring(fishery, 3, 4)) %>% print(n = 100)
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, spcode, size, legal, shell, numcrab) -> out
out %>%
# fix transition to rationalization yr
# cdq and eo fisheries to QO
# bbrkc test fish and cdq fisheries to TR
# early tanner crab fisheries to QT or TT based on e166 line
# fisheries without any dates in dockside data (make hard change)
mutate(fishery = gsub("QO05r", "QO05", fishery),
fishery = gsub("QO05o", "QO04", fishery),
fishery = gsub("CO|EO", "QO", fishery),
fishery = gsub("XR|CR", "TR", fishery),
fishery = ifelse(fishery %in% early_90s_tt, paste0("QT", substring(fishery, 3, 4)), fishery),
fishery = paste0(substring(fishery, 1, 2), substring(crab_year, 3, 4)))
path = "../adfg_crab_observer/tanner_crab/data/AIGKC-1985-2023_retained_size_freq.csv"
dock <- read_csv(path)
path = "../adfg_crab_observer/aigkc/data/AIGKC-1985-2023_retained_size_freq.csv"
dock <- read_csv(path)
dock
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, spcode, size, legal, shell, numcrab) -> out
out
dock %>%
distinct(substring(fishery, 1, 2), subdistrict)
dock %>%
distinct(fishery, subdistrict)
dock
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), spcode, size, legal, shell, numcrab) -> out
out
out
out %>%
# make XE fisheries EAG
mutate(subdistrict = ifelse(substring(fishery, 1, 2) == "XE", "EAG", subdistrict)) %>%
# fix subdistrict for OB08
mutate(subdistrict = case_when(crab_year != 2008 ~ subdistrict,
(crab_year == 2008 & adfg %in% c(35767, 37887)) ~ "WAG",
(crab_year == 2008 & adfg %in% c(103, 5992, 20556)) ~ "EAG",
(crab_year == 2008 & adfg == 5992 & sample_date > as_date("2008-12-1")) ~ "WAG"))
path = "../adfg_crab_observer/pigkc/data/PIGKC-1985-2023_retained_size_freq.csv"
dock <- read_csv(path)
path = "../adfg_crab_observer/pigkc/data/QGKC-1990-2022_retained_size_freq.csv"
dock <- read_csv(path)
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), spcode, size, legal, shell, numcrab) -> out
out
dock %>%
distinct(substring(fishery, 1, 2))
path = "../adfg_crab_observer/smbkc/data/BKC-1990-2023_retained_size_freq.csv"
dock %>%
distinct(substring(fishery, 1, 2))
dock %>%
# add crab year
add_crab_year() %>%
# reorder
transmute(crab_year, fishery, adfg, sample_date, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), spcode, size, legal, shell, numcrab) -> out
path = "../adfg_crab_observer/smbkc/data/BKC-1990-2023_retained_size_freq.csv"
dock <- read_csv(path)
dock %>%
distinct(substring(fishery, 1, 2))
path = "../adfg_crab_observer/smbkc/data/BKC-1990-2023_crab_dump.csv"
obs <- read_csv(path)
obs
obs %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = substring(fishery, 1, 2)))
llibrary(ggplot2)
library(ggplot2)
obs %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = substring(fishery, 1, 2)))
obs %>%
filter(longitude < -100) %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = substring(fishery, 1, 2)))
dock
path = "../adfg_crab_observer/smbkc/data/BKC-1990-2023_potsum.csv"
pots <- read_csv(path)
pots
pots %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = substring(fishery, 1, 2)))
pots %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = description))
pots %>%
filter(substring(fishery, 1, 2) == "QP")
pots %>%
filter(substring(fishery, 1, 2) == "QP")
pots %>%
filter(substring(fishery, 1, 2) == "QP") %>%
distinct(fishery, discription)
pots %>%
filter(substring(fishery, 1, 2) == "QP") %>%
distinct(fishery, description)
39/60
pots %>%
filter(substring(fishery, 1, 2) == "QP", latitude < 58.65) %>%
distinct(fishery, description)
pots %>%
filter(substring(fishery, 1, 2) == "QP", latitude > 58.65) %>%
distinct(fishery, description)
pots %>%
filter(substring(fishery, 1, 2) == "QP", latitude > 58.65)
pots %>%
filter(is.na(latitude))
pots %>%
filter(latitude == -9)
pots %>%
ggplot()+
geom_point(aes(x = longitude, y = latitude, color = substring(fishery, 1, 2))) %>%
print(n = 100)
pots %>%
filter(latitude == -9)%>%
print(n = 100)
pots %>%
filter(latitude == -9)%>%
print(n = 1000)
path = "../adfg_crab_observer/aigkc/data/AIGKC-1990-2023_crab_dump.csv"
obs <- read_csv(path)
obs
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), latitude, longitude,
obs %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest, depth, soaktime, gearcode = ifelse("gearcode" %in% names(.), gearcode, NA), ring, mesh, biotwine_ok, spcode, sex, size, legal, shell, clutch, eggdev,
clutchcon, maturity = ifelse("maturity" %in% names(.), maturity, NA), parasite) -> out
out
stock == "EAG"
stock = "EAG"
out %>%
# fill in legal
add_legal(., stock = stock)
path = "../adfg_crab_observer/aigkc/data/QGKC-1990-2022_crab_dump.csv"
obs <- read_csv(path)
path = "../adfg_crab_observer/pigkc/data/QGKC-1990-2022_crab_dump.csv"
obs <- read_csv(path)
obs %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest, depth, soaktime, gearcode = ifelse("gearcode" %in% names(.), gearcode, NA), ring, mesh, biotwine_ok, spcode, sex, size, legal, shell, clutch, eggdev,
clutchcon, maturity = ifelse("maturity" %in% names(.), maturity, NA), parasite) -> out
obs %>%
count(substring(fishery, 1, 2))
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) -> out
out
path = "../adfg_crab_observer/aigkc/data/AIGKC-1990-2023_potsum.csv"
pot <- read_csv(path)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict))
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(substring(fishery, 1, 2), subdistrict)
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(substring(fishery, 1, 2), subdistrict)
pot <- read_csv(path)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(substring(fishery, 1, 2), subdistrict)
out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot <- read_csv(path)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot <- read_csv(path)
## data mgmt specific to gkc
pot %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), subdistrict, NA), latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict = ifelse("subdistrict" %in% names(.), .$subdistrict, NA), latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict, latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!(subdistrict %in% names(.))){mutate(subdistrict = NA) %>% .}}
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .}}
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .}}
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .}} %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict, latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .} else{.}} %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict, latitude, longitude,
eastwest = ifelse("eastwest" %in% names(.), eastwest, NA), depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
out
## data mgmt specific to gkc
out %>%
#mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
count(subdistrict)
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
# remove pots without district info
filter(subdistrict != "-") -> out
out
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .} else{.}} %>%
{if(!("eastwest" %in% names(.))){mutate(eastwest = NA) %>% .} else{.}} %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict, latitude, longitude, depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
# remove pots without district info
filter(subdistrict != "-") -> out
out
pot %>%
# fix biotwine status data
mutate(biotwine_ok = case_when(biotwine_ok == "-" ~ NA,
biotwine_ok %in% c("n", "N") ~ "N",
biotwine_ok %in% c("y", "Y") ~ "Y")) %>%
{if(!("subdistrict" %in% names(.))){mutate(subdistrict = NA) %>% .} else{.}} %>%
{if(!("eastwest" %in% names(.))){mutate(eastwest = NA) %>% .} else{.}} %>%
rename(sample_date = sampdate) %>%
# reorder
transmute(fishery, trip, adfg, sample_date, spn, statarea, subdistrict, latitude, longitude, eastwest, depth, soaktime, gearcode, ring, mesh, biotwine_ok, female, sublegal, tot_legal, msr_pot) -> out
## data mgmt specific to gkc
out %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
# remove pots without district info
filter(subdistrict != "-") -> out
out
#' Clean Lat and Lon
#'
#' Clean latitude and longitude data across the dateline
#' @param x Pot or observer data with columns longitude, latitude, and eastwest
#' @return x with location information correctect across the date line to be negative
#' @examples
#' clean_lat_lon(pots)
#' @export
clean_lat_lon <- function(x) {
x %>%
mutate(longitude = ifelse(longitude > 0, longitude * -1, longitude),
longitude = ifelse(longitude == -9, NA, longitude),
longitude = ifelse(eastwest == "E", (-180 - longitude) + -180, longitude)) -> out
return(out)
}
## data mgmt specific to gkc
out %>%
clean_lat_lon() %>%
mutate(subdistrict = ifelse(fishery == "OB08" & longitude < -174, "WAG", subdistrict)) %>%
# remove pots without district info
filter(subdistrict != "-") -> out
out
devtools::document()
path = "../adfg_crab_observer/aigkc/data/AIGKC-1990-2023_potsum.csv"
load_dockside(path, stock = "AIGKC")
load_all()
devtools::load_all()
load_dockside(path, stock = "AIGKC")
load_pot_dump(path, stock = "AIGKC")
devtools::document()
